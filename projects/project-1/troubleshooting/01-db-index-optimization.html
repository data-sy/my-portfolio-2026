<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DB 인덱스 최적화를 통한 상품 목록 조회 성능 93% 개선 - Portfolio 2026</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../../assets/css/reset.css">
  <link rel="stylesheet" href="../../../assets/css/global.css">
  <link rel="stylesheet" href="../../../assets/css/layout.css">
  <link rel="stylesheet" href="../../../assets/css/troubleshooting.css">
</head>
<body>
  <!-- Project Header -->
  <header class="project-header">
    <h1 class="project-name">대규모 트래픽 환경 성능 튜닝 프로젝트 <span class="project-version">(v1.0.0)</span></h1>
  </header>

  <main class="troubleshooting type-a">
    <!-- Navigation -->
    <a href="../index.html" class="troubleshooting-nav">&larr; 프로젝트로 돌아가기</a>

    <!-- Title -->
    <h1 class="troubleshooting-title">DB 인덱스 최적화를 통한 상품 목록 조회 성능 93% 개선</h1>

    <!-- Section: 문제 상황 -->
    <section class="troubleshooting-section">
      <h2 class="section-title">📍 문제 상황</h2>
      <div class="section-box">
        <div class="section-content">
          <p><strong>상품 목록 조회 API</strong>에서 성능 병목 발생:</p>
          <ul>
            <li>응답 시간: <strong>2.5초</strong></li>
            <li>Full Table Scan 발생 확인</li>
            <li>카테고리 필터 + 정렬 + 페이징 쿼리에서 병목</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Section: 해결 과정 -->
    <section class="troubleshooting-section">
      <h2 class="section-title">🔧 해결 과정</h2>

      <!-- 분석 단계 -->
      <div class="step-card">
        <div class="step-header">📊 분석</div>
        <div class="step-content">
          <p><strong>EXPLAIN</strong>을 사용하여 쿼리 실행 계획 분석</p>
          <ul>
            <li>Full Table Scan이 발생하고 있음을 확인</li>
            <li>WHERE 조건과 ORDER BY가 인덱스를 타지 않음</li>
            <li>filesort가 발생하여 추가 정렬 비용 발생</li>
          </ul>
        </div>
      </div>

      <!-- 기존 쿼리 -->
      <div class="step-card">
        <div class="step-header">🔴 기존 상태</div>
        <div class="step-content">
          <pre><code>SELECT * FROM products
WHERE category = 'electronics'
ORDER BY created_at DESC
LIMIT 20 OFFSET 0;</code></pre>
          <div class="metric">2.5초</div>
          <p>인덱스 없음 &rarr; Full Table Scan + filesort</p>
        </div>
      </div>

      <div class="step-arrow">↓</div>

      <!-- 시도 1 -->
      <div class="step-card">
        <div class="step-header">시도 1: category 단일 컬럼 인덱스 생성</div>
        <div class="step-content">
          <pre><code>CREATE INDEX idx_category ON products(category);</code></pre>
          <div class="metric">1.8초</div>
          <span class="step-result success">✅ 개선 (28% 감소)</span>
          <p><strong>문제점:</strong> 여전히 filesort 발생 - ORDER BY created_at을 커버하지 못함</p>
        </div>
      </div>

      <div class="step-arrow">↓</div>

      <!-- 시도 2 -->
      <div class="step-card">
        <div class="step-header">시도 2: created_at 단일 컬럼 인덱스 생성</div>
        <div class="step-content">
          <pre><code>CREATE INDEX idx_created_at ON products(created_at DESC);</code></pre>
          <div class="metric">2.1초</div>
          <span class="step-result success">✅ 개선 (16% 감소)</span>
          <p><strong>문제점:</strong> filesort 제거되었으나 category 필터링이 비효율적</p>
        </div>
      </div>

      <div class="step-arrow">↓</div>

      <!-- 시도 3 -->
      <div class="step-card">
        <div class="step-header">시도 3: (category, created_at DESC) 복합 인덱스 적용</div>
        <div class="step-content">
          <pre><code>CREATE INDEX idx_category_created
ON products(category, created_at DESC);</code></pre>
          <div class="metric">180ms</div>
          <span class="step-result success">✅ 개선 (93% 감소)</span>
          <p><strong>개선 포인트:</strong> WHERE 조건 + ORDER BY + 페이징 패턴 전체를 커버하는 복합 인덱스</p>
        </div>
      </div>
    </section>

    <!-- Section: 결과 -->
    <section class="troubleshooting-section">
      <h2 class="section-title">🎯 결과</h2>
      <div class="section-box">
        <div class="section-content">
          <div style="display: flex; justify-content: space-around; align-items: center; margin: 20px 0;">
            <div style="text-align: center;">
              <div style="font-size: 14px; color: var(--color-gray4);">AS-IS</div>
              <div class="metric">2.5초</div>
            </div>
            <div style="font-size: 48px; color: var(--color-gray4);">&rarr;</div>
            <div style="text-align: center;">
              <div style="font-size: 14px; color: var(--color-gray4);">TO-BE</div>
              <div class="metric" style="color: #4CAF50;">180ms</div>
            </div>
          </div>

          <div class="result-bar">
            <div class="result-bar-fill" style="width: 93%;">
              93% 개선
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section: 배운 점 -->
    <section class="troubleshooting-section">
      <h2 class="section-title">💡 배운 점</h2>
      <div class="section-box">
        <div class="section-content">
          <ul>
            <li><strong>인덱스는 설계 문제:</strong> 단순히 "컬럼 추가"가 아니라 WHERE 조건 + 정렬/페이징 패턴까지 포함한 설계 문제임을 깨달았습니다.</li>
            <li><strong>단일 인덱스의 한계:</strong> 복합 조건(필터 + 정렬)은 단일 컬럼 인덱스로 효율적으로 처리할 수 없습니다.</li>
            <li><strong>EXPLAIN 기반 검증:</strong> 각 시도마다 EXPLAIN으로 실행 계획을 확인하여 효과를 정확히 측정해야 합니다.</li>
            <li><strong>인덱스 컬럼 순서:</strong> 복합 인덱스에서 컬럼 순서가 중요합니다. WHERE 조건 컬럼을 먼저, ORDER BY 컬럼을 나중에 배치해야 합니다.</li>
          </ul>
        </div>
      </div>
    </section>
  </main>
</body>
</html>
